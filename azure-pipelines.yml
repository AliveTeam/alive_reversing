
trigger:
- master

jobs:
- job: Linux
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - script: echo hello from Linux
- job: macOS
  pool:
    vmImage: 'macOS-latest'
  steps:
  - script: |
        brew install sdl2
        git submodule update --init	
        cmake --version
        mkdir build
        cd build
        cmake -G"Unix Makefiles" ..
        make -j3
  displayName: 'Clone and build'
- job: Windows32
  pool:
    vmImage: 'windows-latest'
  steps:
  - script: echo hello from Windows 32
- job: Windows64
  pool:
    vmImage: 'windows-latest'
  steps:
  - script: |
        git submodule update --init
        mkdir C:\temp
        powershell Invoke-WebRequest 'https://www.libsdl.org/release/SDL2-devel-2.0.9-VC.zip' -OutFile C:\temp\SDL2-devel-2.0.9-VC.zip
        7z x C:\Temp\SDL2-devel-2.0.9-VC.zip -oC:\Temp
        mkdir build
        cd build
        set AE_ROOT=C:\Temp\AE
        set AO_ROOT=C:\Temp\AO
        cmake .. -DSDL2_DIR=C:\Temp\SDL2-2.0.9 -DBUILD_NUMBER=$(Build.BuildNumber) -G "Visual Studio 16 2019" -A Win32
        cmake --build .
        call "C:\Program Files (x86)\cmake\bin\cpack" -G ZIP -C X86
